from openpyxl import Workbook, load_workbook
from openpyxl.utils import get_column_letter
from openpyxl.worksheet.formula import ArrayFormula

data = {
    'Movimentação 1':{
        'Nome': 'Gabriel',
        'Banco': 'Nu',
        'Data_mov': '12/11/21',
        'Descrição': 'Saldo Inicial',
        'Valor': 500,
        'Saldo': 500
    },
    'Movimentacao 2':{ 
        'Nome': 'Gabriel',
        'Banco': 'Nu',
        'Data_mov': '12/11/21',
        'Descrição': 'Remedio',
        'Valor': 200,
        'Saldo': '' ## CONVERTER A STR EM NUMERO 
    }
}

wb = Workbook()
ws = wb.active
ws.title = 'Saldo'

headings = ['Movimentação'] + list(data['Movimentação 1'].keys())
ws.append(headings)

for movimentacao in data: 
    dados = list(data[movimentacao].values())
    ws.append([movimentacao] + dados)



def atualizar_saldo(ws):
    # Obter o saldo inicial
    saldo_inicial = ws['G2'].value

    # Obter o valor do remédio
    valor_coluna = float(input(ws['F4'].value))
    valor = [ws['F3'].value,valor_coluna]

    # Calcular o saldo atual
    saldo_atual = saldo_inicial - sum(valor)

    # Atualizar o saldo
    #ws['G3'] = 
    ws['G4'] = saldo_atual



# Atualizar o saldo
atualizar_saldo(ws)



wb.save('SALDOXD.xlsx')